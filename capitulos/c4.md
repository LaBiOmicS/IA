# Capítulo 4 – Fundamentos de Estatística para Ciência de Dados

---

## 4.1 Por que Estatística é essencial na Ciência de Dados?

A Estatística é a ciência que estuda como **coletar, organizar, analisar e interpretar dados**.  
Ela é o coração da Ciência de Dados: sem estatística, não conseguimos entender se nossos modelos de Machine Learning realmente fazem sentido.

📌 **Exemplo biomédico:**  
- Ao medir a pressão arterial de 100 pacientes, a estatística nos ajuda a calcular a média, identificar a variabilidade e verificar se há uma associação entre hipertensão e diabetes.

---

## 4.2 Estatística descritiva x inferencial

- **Estatística descritiva:** resume os dados observados (ex.: média da pressão arterial em uma amostra).  
- **Estatística inferencial:** permite tirar conclusões sobre uma população maior a partir de uma amostra (ex.: estimar a prevalência de diabetes em toda uma cidade a partir de 200 pacientes).  

---

## 4.3 Medidas de Tendência Central

Essas medidas representam o “centro” dos dados.  

- **Média:** soma dos valores dividida pelo número de observações.  
- **Mediana:** valor central quando os dados estão ordenados.  
- **Moda:** valor que mais aparece.  

```python
# Exemplo em Python
glicemias = [90, 110, 150, 130, 85, 110, 150]

# Média
media = sum(glicemias) / len(glicemias)

# Mediana
glicemias.sort()
n = len(glicemias)
if n % 2 == 1:
    mediana = glicemias[n//2]
else:
    mediana = (glicemias[n//2 - 1] + glicemias[n//2]) / 2

# Moda (simplificada)
from collections import Counter
moda = Counter(glicemias).most_common(1)[0][0]

print("Média:", media)
print("Mediana:", mediana)
print("Moda:", moda)
```

📌 **Exemplo biomédico:**  
- Média → glicemia média dos pacientes.  
- Mediana → melhor em distribuições assimétricas (ex.: tempo de internação, que pode ter valores extremos).  
- Moda → valor de colesterol mais frequente em uma amostra.  

---

## 4.4 Medidas de Dispersão

Enquanto a tendência central mostra o “centro” dos dados, a **dispersão** mostra o quanto eles variam.

- **Amplitude:** diferença entre maior e menor valor.  
- **Variância:** medida da variabilidade dos dados em relação à média.  
- **Desvio padrão:** raiz quadrada da variância (mais interpretável).  

```python
import math

colesterol = [180, 200, 220, 240, 260]

media = sum(colesterol) / len(colesterol)
variancia = sum((x - media) ** 2 for x in colesterol) / len(colesterol)
desvio_padrao = math.sqrt(variancia)

print("Amplitude:", max(colesterol) - min(colesterol))
print("Variância:", variancia)
print("Desvio padrão:", desvio_padrao)
```

📌 **Exemplo biomédico:**  
Se dois grupos de pacientes têm **a mesma média de glicemia**, mas um grupo tem **alto desvio padrão**, isso significa que nesse grupo há pacientes muito descontrolados (valores muito baixos e muito altos).  

---

## 4.5 Distribuições de Probabilidade

Uma **distribuição** descreve como os dados se espalham.  

### Distribuição Normal (ou Gaussiana)
- É simétrica em torno da média.  
- Muitos fenômenos biológicos seguem aproximadamente essa distribuição (ex.: altura da população, pressão arterial em adultos saudáveis).  

### Outras distribuições importantes
- **Binomial:** útil para eventos de “sucesso/fracasso” (ex.: resultado positivo/negativo em um teste).  
- **Poisson:** modela eventos raros (ex.: número de mutações em um gene em uma população).  

```python
import random

# Simulação simples de distribuição normal
dados = [random.gauss(100, 15) for _ in range(1000)]
print("Exemplo de 10 valores simulados:", dados[:10])
```

---

## 4.6 Probabilidade básica

A probabilidade mede a chance de um evento acontecer.  

- **Evento:** ocorrência de interesse (ex.: paciente ser diabético).  
- **Espaço amostral:** conjunto de todos os possíveis resultados.  
- **Probabilidade condicional:** chance de um evento acontecer dado que outro ocorreu.  

📌 **Exemplo biomédico:**  
Probabilidade de um paciente ter hipertensão dado que ele tem diabetes.  

```python
# Exemplo simples de probabilidade condicional
total = 100
diabeticos = 40
hipertensos = 30
diabete_hipertensao = 20

p_diabete = diabeticos / total
p_hipertensao = hipertensos / total
p_condicional = diabete_hipertensao / diabeticos

print("P(Diabete):", p_diabete)
print("P(Hipertensão):", p_hipertensao)
print("P(Hipertensão | Diabete):", p_condicional)
```

---

## 4.7 Correlação e Associação

A correlação mede a intensidade da relação entre duas variáveis.  

- **Correlação positiva:** quando uma aumenta, a outra também aumenta.  
- **Correlação negativa:** quando uma aumenta, a outra diminui.  
- **Correlação nula:** não há relação clara.  

📌 **Exemplo biomédico:**  
Correlação positiva entre **IMC** e **glicemia**; correlação negativa entre **atividade física** e **colesterol**.  

---

## 4.8 Conclusão

Neste capítulo aprendemos:  
- A importância da estatística na Ciência de Dados.  
- Diferença entre estatística descritiva e inferencial.  
- Medidas de tendência central e de dispersão.  
- Noções de distribuições de probabilidade.  
- Conceitos básicos de probabilidade.  
- Correlação entre variáveis.  

👉 Agora estamos prontos para o próximo capítulo, onde entraremos no **ecossistema de bibliotecas Python** que tornam essas análises mais fáceis e poderosas.

---

## ✍️ Exercícios do Capítulo 4

1. Explique com suas palavras a diferença entre estatística descritiva e inferencial.  
2. Dê um exemplo biomédico onde a mediana é mais útil que a média.  
3. Calcule manualmente a variância de uma lista de glicemias: `[90, 110, 150, 130, 85]`.  
4. Simule o lançamento de uma moeda 10 vezes e calcule a probabilidade de sair “cara”.  
5. Escreva um código em Python que calcule média, mediana e moda de uma lista de colesterol.  
6. Explique um caso de aplicação da distribuição de Poisson em saúde.  
7. Dê um exemplo biomédico de correlação positiva e um de correlação negativa.  
8. Leia no livro *Mãos à Obra* a seção sobre estatística aplicada e resuma como ela prepara o terreno para ML.  
9. Simule 100 valores de pressão arterial com distribuição normal (média=120, desvio=15). Calcule a média dos valores simulados.  
10. Reflita: por que conhecer estatística é essencial antes de aplicar algoritmos de ML?  

---

## 🔙 Navegação

- ⬅️ [Voltar ao Sumário do Curso](../README.md)


---

# 📑 Lista de 50 Exercícios Extras – Estatística em Python

> Observação: sempre que possível, use **apenas Python básico** (`math`, `random`, `statistics`, `collections`) para reforçar os conceitos antes de recorrer a bibliotecas científicas.

## 🔹 Seção A — Tendência Central (1–8)
1. Implemente funções `media(lista)`, `mediana(lista)` e `moda(lista)` sem usar bibliotecas.  
2. Dada uma lista de glicemias, escreva um programa que compare a média e a mediana e explique quando elas divergem.  
3. Gere 20 valores de pressão arterial sistólica com `random.randint(90, 180)` e calcule média e mediana.  
4. Crie duas listas com tempos de internação (dias), uma com poucos outliers e outra com muitos. Compare médias e medianas.  
5. Calcule a **média ponderada** de notas de um exame com pesos diferentes para teoria e prática.  
6. Para uma lista de contagens de leucócitos, encontre a moda (se houver múltiplas, retorne todas).  
7. Escreva `quartis(lista)` que retorne Q1, Q2 (mediana) e Q3 manualmente.  
8. Calcule o **IQR** (intervalo interquartílico) e use-o para detectar outliers (regra de 1.5×IQR).  

## 🔹 Seção B — Dispersão e Padronização (9–16)
9. Implemente `variancia_pop(lista)` e `desvio_padrao_pop(lista)` sem bibliotecas.  
10. Adapte para `variancia_amostral(lista)` dividindo por *n − 1*.  
11. Calcule a **amplitude** (máx − mín) de uma lista de colesterol.  
12. Escreva uma função que padronize uma lista (transforme em **z-scores**).  
13. Compare duas turmas: mesmas médias de nota porém desvios diferentes. Interprete.  
14. Dado um conjunto de IMC, calcule o **coeficiente de variação** (desvio/média).  
15. Para duas listas (idade e glicemia do mesmo grupo), compute a **covariância** manualmente.  
16. Baseado na covariância, calcule a **correlação de Pearson** manualmente (sem `statistics`).  

## 🔹 Seção C — Probabilidade Básica (17–24)
17. Simule 1.000 lançamentos de moeda e estime P(cara). Compare com 0,5.  
18. Simule 1.000 lançamentos de dado e estime P(resultado ≤ 2).  
19. Implemente uma função para **probabilidade condicional** P(A|B) a partir de contagens.  
20. Monte uma **tabela de contingência** 2×2 (diabetes × hipertensão) e calcule risco relativo.  
21. Verifique **independência** entre dois eventos simulados comparando P(A∩B) e P(A)P(B).  
22. Problema médico: um teste tem sensibilidade 0,9 e especificidade 0,95; com prevalência 5%, calcule o **VPP** (teorema de Bayes).  
23. Simule a falsopositividade de um teste em 10.000 indivíduos e compare com o valor teórico.  
24. Calcule **odds** e **odds ratio** entre dois grupos (fumar vs. não fumar) para doença pulmonar.  

## 🔹 Seção D — Distribuições (25–34)
25. Simule **Bernoulli(p)** para p=0,3 em 1.000 tentativas e estime a média (≈ p).  
26. Simule **Binomial(n, p)** com n=10, p=0,4 (repetir 5.000 vezes) e estime média e variância.  
27. Simule **Poisson(λ=3)** (5.000 amostras) e conte a frequência de {0,1,2,3,4,5}.  
28. Gere 5.000 amostras de **Normal(μ=120, σ=15)** para pressão sistólica e estime média e desvio.  
29. Verifique a **regra 68–95–99.7** contando quantos valores caem em 1σ, 2σ, 3σ da média.  
30. Compare **Binomial(n grande, p pequeno)** com **Poisson(λ=np)** via simulação.  
31. Simule tempos entre eventos raros com **Exponencial(λ)** usando `random.expovariate`.  
32. Gere alturas com Normal, converta para **z-scores** e conte quantos têm |z|>2.  
33. Construa empiricamente um **histograma** (contagens por faixas) sem usar bibliotecas.  
34. Estime a pdf de uma Normal por uma grade de pontos e compare com frequências simuladas.  

## 🔹 Seção E — Amostragem e CLT (35–42)
35. A partir de uma “população” sintética de colesterol (10.000 valores), extraia amostras de tamanhos 5, 30, 100 e compare as médias.  
36. Para cada tamanho de amostra, repita 1.000 vezes e observe a distribuição das médias (**CLT**).  
37. Estime o **erro padrão da média** (σ/√n) por simulação e compare com o teórico.  
38. Construa **intervalos de confiança** (95%) para a média usando Normal (σ conhecido) por simulação.  
39. Explore o efeito do tamanho da amostra no comprimento do intervalo de confiança.  
40. Verifique a robustez da média versus mediana quando há **outliers** injetados artificialmente.  
41. Simule **viés de seleção**: amostre apenas pacientes com exames recentes e compare com a população.  
42. Mostre como **amostragem estratificada** reduz a variância (ex.: estratos por faixa etária).  

## 🔹 Seção F — Associação e Regressão Univariada (43–47)
43. Calcule manualmente a **reta de mínimos quadrados** (y = a + bx) para (IMC → glicemia).  
44. Estime **R²** manualmente (1 − SQres/SQt).  
45. Avalie a sensibilidade do ajuste a um **outlier extremo**: refaça a reta com e sem o ponto.  
46. Compare correlação **Pearson** (linear) e **Spearman** (ordens) implementando Spearman por ranks.  
47. Faça uma simulação onde a correlação é zero, mas a relação é **não linear** (ex.: y = x² + ruído).  

## 🔹 Seção G — Estudos de Caso Biomédicos (48–50)
48. Crie um conjunto sintético com (idade, pressão, colesterol, glicemia) para 200 pacientes; descreva estatísticas por faixa etária.  
49. Modele o **número de mutações** por gene com Poisson e verifique ajuste por qui-quadrado (contagem vs. esperado).  
50. Simule um **ensaio diagnóstico** com sensibilidade 92%, especificidade 97% e prevalência 8%; estime VPP e VPN por simulação de 50.000 indivíduos e compare com os valores teóricos.  
